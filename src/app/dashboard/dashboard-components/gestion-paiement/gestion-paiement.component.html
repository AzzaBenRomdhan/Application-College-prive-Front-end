<div class="menu2-container">
  <!-- Affichage du Menu du Jour -->
  <div class="menu-card">
    <div class="menu-header">
      <h3>Enregistrer un paiement</h3>
    </div>
    <div class="menu-body">
      <form [formGroup]="payementForm" (ngSubmit)="onSubmit()">
        <div *ngIf="loading" class="loader-container">
          <div class="spinner"></div>
          <p>Chargement en cours...</p>
        </div>
        <!-- Messages de succès ou d'erreur -->
        <div *ngIf="successMessage" class="alert alert-success mt-3">
          {{ successMessage }}
        </div>
        <div class="form-group">
          <mat-form-field appearance="outline" class="w-100">
            <mat-label>Matricule</mat-label>
            <input matInput id="matricule" formControlName="matricule" />
            <mat-error *ngIf="payementForm.get('matricule')?.hasError('required')">
              Le matricule est requis.
            </mat-error>
            <mat-error *ngIf="payementForm.get('matricule')?.hasError('minlength')">
              Le matricule doit contenir au moins 5 caractères.
            </mat-error>
          </mat-form-field>
        </div>

        <div class="form-group">
          <mat-form-field appearance="outline" class="w-100">
            <mat-label>Montant Payé</mat-label>
            <input matInput id="amountPaye" type="number" formControlName="amountPaye" />
            <mat-error *ngIf="payementForm.get('amountPaye')?.hasError('required')">
              Le montant payé est requis.
            </mat-error>
            <mat-error *ngIf="payementForm.get('amountPaye')?.hasError('min')">
              Le montant payé doit être supérieur à 0.
            </mat-error>
          </mat-form-field>
        </div>

        <div class="form-group">
          <mat-form-field appearance="outline" class="w-100">
            <mat-label>Mode de Paiement</mat-label>
            <mat-select id="modepay" formControlName="modepay">
              <mat-option *ngFor="let mode of modepayOptions" [value]="mode">{{ mode }}</mat-option>
            </mat-select>
            <mat-error *ngIf="payementForm.get('modepay')?.hasError('required')">
              Le mode de paiement est requis.
            </mat-error>
          </mat-form-field>
        </div>

        <div class="form-group">
          <mat-form-field appearance="outline" class="w-100">
            <mat-label>Modalité de Paiement</mat-label>
            <mat-select id="modalitePay" formControlName="modalitePay">
              <mat-option *ngFor="let modalite of modalitePayOptions" [value]="modalite">{{ modalite }}</mat-option>
            </mat-select>
            <mat-error *ngIf="payementForm.get('modalitePay')?.hasError('required')">
              La modalité de paiement est requise.
            </mat-error>
          </mat-form-field>
        </div>

        <div class="form-group">
          <mat-form-field appearance="outline" class="w-100">
            <mat-label>Type de Paiement</mat-label>
            <mat-select id="typepay" formControlName="typepay">
              <mat-option *ngFor="let type of typepayOptions" [value]="type">{{ type }}</mat-option>
            </mat-select>
            <mat-error *ngIf="payementForm.get('typepay')?.hasError('required')">
              Le type de paiement est requis.
            </mat-error>
          </mat-form-field>
        </div>

        <div class="form-group">
          <mat-form-field appearance="outline" class="w-100">
            <mat-label>Statut de Paiement</mat-label>
            <mat-select id="statuspay" formControlName="statuspay">
              <mat-option *ngFor="let status of statuspayOptions" [value]="status">{{ status }}</mat-option>
            </mat-select>
            <mat-error *ngIf="payementForm.get('statuspay')?.hasError('required')">
              Le statut de paiement est requis.
            </mat-error>
          </mat-form-field>
        </div>

        <div class="form-group">
          <mat-form-field appearance="outline" class="w-100">
            <mat-label>Trimestre (facultatif)</mat-label>
            <mat-select id="trimestre" formControlName="trimestre">
              <mat-option *ngFor="let trimestre of trimestreOptions" [value]="trimestre">{{ trimestre }}</mat-option>
            </mat-select>
          </mat-form-field>
        </div>

        <div class="form-group">
          <mat-form-field appearance="outline" class="w-100">
            <mat-label>Date (facultatif)</mat-label>
            <input matInput id="date" type="date" formControlName="date" />
          </mat-form-field>
        </div>

        <button type="submit" class="btn btn-primary mt-3">Enregistrer</button>
      </form>
      <div *ngIf="errorMessage" class="alert alert-danger mt-3">
        {{ errorMessage }}
      </div>
    </div>
  </div>
</div>
